<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="记录蜂窝网络链路聚合项目的零碎"><meta name="keywords" content="VPN,LTE,GSM,IPsec"><meta name="author" content="Ykk,undefined"><meta name="copyright" content="Ykk"><title>记录蜂窝网络链路聚合项目的零碎 | Ykk</title><link rel="shortcut icon" href="/my-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.5.6"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.5.6"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="dns-prefetch" href="https://unpkg.com"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitment/style/default.css"><script src="https://cdn.jsdelivr.net/npm/gitment/dist/gitment.browser.js"></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#对开源IPsec-VPN的研究"><span class="toc-number">1.</span> <span class="toc-text">对开源IPsec VPN的研究</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#StrongSwan-vs-OpenSwan-vs-Libreswan"><span class="toc-number">1.1.</span> <span class="toc-text">StrongSwan vs OpenSwan vs Libreswan</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OpenSwan-roadwarrior-and-net2net"><span class="toc-number">1.2.</span> <span class="toc-text">OpenSwan roadwarrior and net2net</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#StrongSwan的HA模式"><span class="toc-number">1.3.</span> <span class="toc-text">StrongSwan的HA模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#VPN链路聚合的两种方案"><span class="toc-number">1.4.</span> <span class="toc-text">VPN链路聚合的两种方案</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#硬件问题"><span class="toc-number">2.</span> <span class="toc-text">硬件问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SIM7100拨号脚本"><span class="toc-number">3.</span> <span class="toc-text">SIM7100拨号脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#代码"><span class="toc-number">3.1.</span> <span class="toc-text">代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#上网设置APN-拨号号码，帐号和密码"><span class="toc-number">3.2.</span> <span class="toc-text">上网设置APN,拨号号码，帐号和密码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OpenSwan源码解析"><span class="toc-number">4.</span> <span class="toc-text">OpenSwan源码解析</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://blog-1252404748.cos.ap-chengdu.myqcloud.com/avatar.jpg"></div><div class="author-info__name text-center">Ykk</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="https://github.com/cloisonne" target="_blank">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">54</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">43</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">12</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://blog-1252404748.cos.ap-chengdu.myqcloud.com/bg-1.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Ykk</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a><a class="site-page" href="/">Home</a><a class="site-page" href="/about">About</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/resume">Resume</a></span></div><div id="post-info"><div id="post-title">记录蜂窝网络链路聚合项目的零碎</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2016-10-11</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Notes/">Notes</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">549</span><span class="post-meta__separator">|</span><span>Reading time: 3 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>项目是要保密的，所以只是记录一些自己项目过程里的零零碎碎。</p>
<a id="more"></a>
<hr>
<h3 id="对开源IPsec-VPN的研究"><a href="#对开源IPsec-VPN的研究" class="headerlink" title="对开源IPsec VPN的研究"></a>对开源IPsec VPN的研究</h3><h4 id="StrongSwan-vs-OpenSwan-vs-Libreswan"><a href="#StrongSwan-vs-OpenSwan-vs-Libreswan" class="headerlink" title="StrongSwan vs OpenSwan vs Libreswan"></a>StrongSwan vs OpenSwan vs Libreswan</h4><p>Libreswan是OpenSwan开发者因为商标问题新开发的开源VPN工具。</p>
<ul>
<li>StrongSwan has much more comprehensive and developed documentation than Libreswan.</li>
<li>StrongSwan has support for EAP authentication methods, which make it easier to integrate into heterogeneous environments (such as authenticating to Active Directory). These are less well developed or even missing from Libreswan.</li>
<li>StrongSwan can be clustered and load balanced. Libreswan does not seem to have any support to do either.</li>
<li>Libreswan supports more hardware crypto accelerators than StrongSwan, but requires kernel patches to do so.</li>
</ul>
<h4 id="OpenSwan-roadwarrior-and-net2net"><a href="#OpenSwan-roadwarrior-and-net2net" class="headerlink" title="OpenSwan roadwarrior and net2net"></a>OpenSwan roadwarrior and net2net</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">config setup</span><br><span class="line">    dumpdir=/var/run/pluto/</span><br><span class="line">    nat_traversal=yes</span><br><span class="line">    virtual_private=%v4:10.0.0.0/8,%v4:192.168.0.0/16,%v4:172.16.0.0/12,%v6:fd00::/8,%v6:fe80::/10</span><br><span class="line">    protostack=netkey</span><br><span class="line">    </span><br><span class="line">conn L2TP-PSK-NAT</span><br><span class="line">    rightsubnet=vhost:%priv</span><br><span class="line">    also=L2TP-PSK-noNAT</span><br><span class="line"></span><br><span class="line">conn L2TP-PSK-noNAT</span><br><span class="line">    authby=secret</span><br><span class="line">    pfs=no</span><br><span class="line">    auto=add</span><br><span class="line">    keyingtries=3</span><br><span class="line">    ikelifetime=8h</span><br><span class="line">    keylife=1h</span><br><span class="line">    type=transport</span><br><span class="line">    left=%SERVERIP%</span><br><span class="line">    leftprotoport=17/1701</span><br><span class="line">    right=%any</span><br><span class="line">    rightprotoport=17/%any</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">conn net-to-net </span><br><span class="line">    left=192.168.1.10              # LServer外网IP地址 </span><br><span class="line">    leftsubnet=10.10.10.0/24       # LServer内网IP段</span><br><span class="line">    leftrsasigkey=0sAQOBIJFmj…   # LServer的公钥 </span><br><span class="line">    leftnexthop=%defaultroute      # LServer的下一跳指定为默认路由地址 </span><br><span class="line">    right=192.168.1.20             # RServer外网IP地址 </span><br><span class="line">    rightsubnet=100.10.20.0/24      # RServer内网IP段</span><br><span class="line">    rightrsasigkey=0sAQNZZZjj…   # Rserver的公钥 </span><br><span class="line">    rightnexthop=%defaultroute     # RServer的下一跳指定为默认路由地址 </span><br><span class="line">    auto=start                     # 添加这个链接，启动时自动连接</span><br></pre></td></tr></table></figure>
<h4 id="StrongSwan的HA模式"><a href="#StrongSwan的HA模式" class="headerlink" title="StrongSwan的HA模式"></a>StrongSwan的HA模式</h4><p>The roadwarriors carol and dave set up a connection each to the virtual gateway mars implemented by the two real gateways alice and moon in a High Availability (HA) setup based on ClusterIP. Depending on the hash of the IP addresses of the peers and the SPIs, the inbound and outbound CHILD_SAs are either assigned to segment 1 managed by alice or segment 2 handled by moon. The IKEv2 protocol is managed by moon exclusively with passive IKE_SAs installed on the backup gateway alice. </p>
<p><img src="http://o7myibfc7.bkt.clouddn.com/strongswan.png" alt="StrongSwan的HA模式"></p>
<h4 id="VPN链路聚合的两种方案"><a href="#VPN链路聚合的两种方案" class="headerlink" title="VPN链路聚合的两种方案"></a>VPN链路聚合的两种方案</h4><ul>
<li>主要实现还是利用了<code>Netfilter HOOK</code></li>
</ul>
<p><img src="http://o7myibfc7.bkt.clouddn.com/vpn1.png" alt="《支持多路负载平衡的IPsec VPN 系统的设计与实现》"></p>
<p><img src="http://o7myibfc7.bkt.clouddn.com/vpn2.png" alt="《高可用IPsec虚拟专用网研究》"></p>
<hr>
<h3 id="硬件问题"><a href="#硬件问题" class="headerlink" title="硬件问题"></a>硬件问题</h3><ul>
<li>常见天线接头类型:</li>
</ul>
<p><img src="http://o7myibfc7.bkt.clouddn.com/TB29215.jpg?imageView2/3/w/300/h/150/q/90" alt="常见天线接头类型"></p>
<hr>
<h3 id="SIM7100拨号脚本"><a href="#SIM7100拨号脚本" class="headerlink" title="SIM7100拨号脚本"></a>SIM7100拨号脚本</h3><h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><p>详见gayhub：</p>
<div class="github-widget" data-repo="cloisonne/SIM7100-dial-script"></div>

<h4 id="上网设置APN-拨号号码，帐号和密码"><a href="#上网设置APN-拨号号码，帐号和密码" class="headerlink" title="上网设置APN,拨号号码，帐号和密码"></a>上网设置APN,拨号号码，帐号和密码</h4><table>
<thead>
<tr>
<th>运营商（ISP）</th>
<th>APN</th>
<th>拨号号码</th>
<th>帐号</th>
<th>密码</th>
</tr>
</thead>
<tbody>
<tr>
<td>中国联通WCDMA（China Unicom）</td>
<td>3GNET</td>
<td>*99#</td>
<td>空</td>
<td>空</td>
</tr>
<tr>
<td>中国电信CDMA2000（China Telecom）EVDO网络</td>
<td>空</td>
<td>#777</td>
<td><a href="mailto:ctnet@mycdma.cn" target="_blank" rel="noopener">ctnet@mycdma.cn</a></td>
<td>vnet.mobi</td>
</tr>
<tr>
<td>1X网络</td>
<td>空</td>
<td>#777</td>
<td>card (CARD)</td>
<td>card（CARD）</td>
</tr>
<tr>
<td>中国移动 TD-SCDMA（China Mobile）</td>
<td>CMNET</td>
<td><em>98</em>1#</td>
<td>空</td>
<td>空</td>
</tr>
<tr>
<td>中国移动 GPRS（China Mobile）</td>
<td>CMNET</td>
<td><em>99**</em>1#</td>
<td>空</td>
<td>空</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="OpenSwan源码解析"><a href="#OpenSwan源码解析" class="headerlink" title="OpenSwan源码解析"></a>OpenSwan源码解析</h3><p>后面没有使用开源VPN，这里没有继续接触。</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Ykk</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://ykksmile.top/posts/50343/">https://ykksmile.top/posts/50343/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/VPN/">VPN</a><a class="post-meta__tags" href="/tags/LTE/">LTE</a><a class="post-meta__tags" href="/tags/GSM/">GSM</a><a class="post-meta__tags" href="/tags/IPsec/">IPsec</a></div><div class="social-share" data-disabled="google,facebook,twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/posts/59760/"><i class="fa fa-chevron-left">  </i><span>做了一些改变</span></a></div><div class="next-post pull-right"><a href="/posts/53056/"><span>用到的sublime快捷键</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitment-container"></div><script>var gitment = new Gitment({
  owner: 'cloisonne',
  repo: 'cloisonne.github.io',
  oauth: {
    client_id: 'd6cdb36f97d08963e9cc',
    client_secret: '32f854846bf95d283ee654337570bbed41f69f03'
  }
})
gitment.render('gitment-container')</script></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2016 - 2018 By Ykk</div><div class="framework-info"><span>Driven By   </span><a href="https://pages.coding.me"><span>Coding Pages </span></a><!--span.footer-separator |--><!--i(class='fa fa-heart animated infinite pulse')--><!--span= _p('footer.theme') + ' - '--><span> &amp; </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="icp"><a><span>陕ICP备18010505号</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.6"></script><script src="/js/fancybox.js?version=1.5.6"></script><script src="/js/sidebar.js?version=1.5.6"></script><script src="/js/copy.js?version=1.5.6"></script><script src="/js/fireworks.js?version=1.5.6"></script><script src="/js/transition.js?version=1.5.6"></script><script src="/js/scroll.js?version=1.5.6"></script><script src="/js/head.js?version=1.5.6"></script><script src="/js/search/local-search.js"></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>